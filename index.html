<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Canopy: Live Whiteboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    
    <!-- KaTeX for LaTeX rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css" integrity="sha384-KiWOvVjnN8qwKMvhIqsNOHQGMZGYB0sQd/jNRESjYNaQszC/PqY+vB3F8TAiWlD2" crossorigin="anonymous">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.js" integrity="sha384-hIoBPJpTUs74ddcyHhN2MFgOEqe/AAyQill/7jT/G/POaRhD3HVI3AyL+YMKDkP/" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/Gf1ES3cgjQTBqQAiE2+knoPgZEeYWYwnGOvv+NtNo+An8WKS" crossorigin="anonymous" onload="document.dispatchEvent(new Event('katexLoaded'))"></script>

    <!-- PDF.js for PDF parsing -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.min.js"></script>
    
    <!-- Mammoth.js for .docx parsing -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js"></script>

    <!-- jspdf and html2canvas for PDF export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* bg-slate-50 */
        }
        .visual-card {
            opacity: 0;
            transform: scale(0.9);
            animation: fadeIn 0.5s forwards;
            position: absolute; /* Needed for dragging */
            cursor: grab;
            transition: box-shadow .3s ease-in-out, transform .3s ease-in-out;
        }
        .visual-card:active {
            cursor: grabbing;
            box-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1); /* shadow-xl */
            transform: scale(1.05);
            z-index: 50;
        }
        @keyframes fadeIn {
            to {
                opacity: 1;
                transform: scale(1);
            }
        }
        .loader {
            border: 4px solid #f3f4f6; /* border-gray-100 */
            border-top: 4px solid #2f7400; /* accent color */
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        .status-loader {
            width: 16px;
            height: 16px;
            border: 2px solid #a7f3d0; /* green-200 */
            border-top: 2px solid #10b981; /* green-500 */
            border-radius: 50%;
            display: inline-block;
            vertical-align: middle;
            margin-right: 8px;
            animation: spin 0.8s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .katex-display {
            overflow-x: auto;
            overflow-y: hidden;
            padding-bottom: 0.5rem; /* Add some space for scrollbar */
        }
        /* Sidebar scrollbar styling */
        .sidebar-scroll::-webkit-scrollbar {
            width: 6px;
        }
        .sidebar-scroll::-webkit-scrollbar-thumb {
            background: #cbd5e1; /* slate-300 */
            border-radius: 3px;
        }
        .sidebar-scroll::-webkit-scrollbar-thumb:hover {
            background: #94a3b8; /* slate-400 */
        }
        /* Whiteboard backgrounds */
        .bg-grid {
             background-color: #ffffff;
             background-image:
                linear-gradient(to right, #e2e8f0 1px, transparent 1px),
                linear-gradient(to bottom, #e2e8f0 1px, transparent 1px);
             background-size: 20px 20px;
        }
        .bg-lined {
            background-color: #ffffff;
            background-image: linear-gradient(to bottom, #e2e8f0 1px, transparent 1px);
            background-size: 100% 24px; /* Line height */
        }
        /* Custom styles for toolbar dropdowns */
        .toolbar-dropdown {
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            margin-top: 8px;
            z-index: 50;
        }
        /* Custom styles for markdown rendering */
        .prose h1, .prose h2, .prose h3, .prose h4 {
            font-weight: 700;
            margin-top: 1.5rem;
            margin-bottom: 0.75rem;
            color: #1e293b;
        }
        .prose h1 { font-size: 1.5rem; border-bottom: 1px solid #e2e8f0; padding-bottom: 0.5rem; }
        .prose h2 { font-size: 1.25rem; border-bottom: 1px solid #e2e8f0; padding-bottom: 0.5rem; }
        .prose h3 { font-size: 1.1rem; }
        .prose h4 { font-size: 1rem; }
        .prose ul, .prose ol { margin-top: 0.5rem; padding-left: 1.5rem; }
        .prose ul { list-style-type: disc; }
        .prose ol { list-style-type: decimal; }
        .prose li { margin-bottom: 0.5rem; color: #475569; }
        .prose p { color: #475569; line-height: 1.6; margin-bottom: 1rem; }
        .prose strong { color: #0f172a; }
        .prose a { color: #2563eb; text-decoration: underline; }
        .prose code { background-color: #f1f5f9; padding: 0.2rem 0.4rem; border-radius: 0.25rem; font-size: 0.9em; color: #0f172a; }
        .prose pre { background-color: #f1f5f9; padding: 1rem; border-radius: 0.5rem; overflow-x: auto; }
        .prose pre code { padding: 0; background-color: transparent; }
        .prose blockquote {
            border-left: 4px solid #94a3b8;
            padding-left: 1rem;
            margin-left: 0;
            font-style: italic;
            color: #334155;
        }
        .summary-content.prose h2 { font-size: 1.25rem; margin-top: 0; border-bottom: 0; }
        .summary-content.prose p { margin-bottom: 0.5rem; }
        .summary-content.prose ul { margin-top: 0; }

        /* Toast animations */
        @keyframes fadeInRight { from { opacity: 0; transform: translateX(100%); } to { opacity: 1; transform: translateX(0); } }
        @keyframes fadeOutRight { from { opacity: 1; transform: translateX(0); } to { opacity: 0; transform: translateX(100%); } }
        @keyframes progress { from { width: 100%; } to { width: 0%; } }
        .animate-fadeInRight { animation: fadeInRight 0.3s ease-out forwards; }
        .animate-fadeOutRight { animation: fadeOutRight 0.3s ease-in forwards; }
        .animate-progress { animation: progress 5s linear forwards; }
    </style>
<script type="importmap">
{
  "imports": {
    "@google/genai": "https://aistudiocdn.com/@google/genai@^1.27.0",
    "react": "https://aistudiocdn.com/react@^19.2.0",
    "react/": "https://aistudiocdn.com/react@^19.2.0/",
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.2.0/",
    "marked": "https://aistudiocdn.com/marked@^16.4.1",
    "jspdf": "https://aistudiocdn.com/jspdf@^3.0.3",
    "html2canvas": "https://aistudiocdn.com/html2canvas@^1.4.1"
  }
}
</script>
</head>
<body class="text-slate-800">
    <div id="root" class="flex h-screen bg-slate-50 text-slate-800">
      <!-- App will be rendered here by index.tsx -->
    </div>
    <script type="module" src="index.tsx"></script>
</body>
</html>